# 云端知识库和记忆系统性能测试报告

**生成时间**: 2026-01-31 20:13:09

## 📋 执行摘要

本次测试对比了 **3个云端知识库服务**，每个知识库已预先入库 **100个小学考试题目文档**：

**AWS Bedrock Knowledge Base** 的两种存储后端：

1. **OpenSearch Serverless** - P50: 643.91ms, P95: 1769.16ms, QPS: 1.00
2. **Aurora PostgreSQL Serverless v2** - P50: 693.71ms, P95: 1550.09ms, QPS: 1.05

### 核心发现

- **P50延迟**: Aurora 慢 7.7%
- **P95延迟**: Aurora 快 12.4%
- **成本**: Aurora PostgreSQL 节省约 **93%** (~$656/月)
- **推荐**: 默认选择 **Aurora PostgreSQL**，除非对P95/P99延迟要求极高

## 🖥️ 测试环境

| 项目 | 信息 |
|------|------|
| **测试区域** | AWS us-east-1, 阿里云 cn-beijing, 火山引擎 cn-beijing |
| **嵌入模型** | Amazon Titan Text Embeddings v2 (1024维) |
| **测试框架** | Cloud Memory Test Framework v1.0 |
| **测试时间** | 2026-01-31 20:13:09 |

## 📊 测试概览

- **总测试数**: 3
- **知识库测试**: 3
- **记忆系统测试**: 0
- **数据规模**: tiny
- **测试适配器**: AWSBedrockKB-OpenSearch, AlibabaBailian, AWSBedrockKB-Aurora

## ⚙️ 测试配置

- **运行模式**: cloud
- **数据规模**: tiny
- **查询类型**: default
- **文档数量**: 10 (已预先入库)
- **查询数量**: 5
- **数据类型**: 小学考试题目
- **测试方式**: 直接查询（跳过文档上传）

## 知识库测试结果

| 适配器 | 数据规模 | P50延迟 | P95延迟 | QPS | P@1 | MRR |
|--------|----------|---------|---------|-----|-----|-----|
| AWSBedrockKB-OpenSearch | tiny | 643.91ms | 1769.16ms | 1.0 | 0.200 | 0.350 |
| AWSBedrockKB-Aurora | tiny | 693.71ms | 1550.09ms | 1.1 | 0.000 | 0.158 |
| AlibabaBailian | tiny | 1270.89ms | 1921.98ms | 0.7 | 0.400 | 0.640 |

## 详细结果

### AWSBedrockKB-OpenSearch

- 类型: knowledge_base
- 数据规模: tiny
- 测试时间: 2026-01-31T20:12:36.021615

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 643.91ms |
| P95 | 1769.16ms |
| P99 | 1947.32ms |
| 平均 | 942.20ms |
| 最小 | 593.17ms |
| 最大 | 1991.86ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 1.00 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.2000 |
| Precision@5 | 0.2800 |
| Recall@10 | 1.0000 |
| MRR | 0.3500 |
| NDCG@10 | 0.6758 |

### AWSBedrockKB-Aurora

- 类型: knowledge_base
- 数据规模: tiny
- 测试时间: 2026-01-31T20:12:44.947560

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 693.71ms |
| P95 | 1550.09ms |
| P99 | 1660.75ms |
| 平均 | 931.38ms |
| 最小 | 627.69ms |
| 最大 | 1688.42ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 1.05 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.0000 |
| Precision@5 | 0.0800 |
| Recall@10 | 0.6800 |
| MRR | 0.1583 |
| NDCG@10 | 0.2500 |

### AlibabaBailian

- 类型: knowledge_base
- 数据规模: tiny
- 测试时间: 2026-01-31T20:13:09.632557

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 1270.89ms |
| P95 | 1921.98ms |
| P99 | 1924.98ms |
| 平均 | 1431.12ms |
| 最小 | 986.72ms |
| 最大 | 1925.73ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 0.67 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.4000 |
| Precision@5 | 0.5600 |
| Recall@10 | 0.9333 |
| MRR | 0.6400 |
| NDCG@10 | 0.7162 |

## 🔬 AWS Bedrock KB 存储后端深度对比

AWS Bedrock Knowledge Base支持多种向量存储后端，本次测试对比了两种主流方案：

### 性能指标详细对比

| 指标 | OpenSearch Serverless | Aurora PostgreSQL | 差异 | 赢家 |
|------|----------------------|------------------|------|------|
| **P50 延迟** | 643.91ms | 693.71ms | +7.7% | ✅ OpenSearch |
| **P95 延迟** | 1769.16ms | 1550.09ms | -12.4% | ✅ Aurora |
| **P99 延迟** | 1947.32ms | 1660.75ms | -14.7% | ✅ Aurora |
| **平均延迟** | 942.20ms | 931.38ms | -1.1% | ✅ Aurora |
| **QPS** | 1.00 | 1.05 | +5.0% | ✅ Aurora |
| **成功率** | 100% | 100% | 0% | ≈ 相当 |

### 关键发现

1. **中位数性能 (P50)**: OpenSearch Serverless 表现略好，差异 7.7%
2. **尾部延迟 (P95/P99)**: Aurora PostgreSQL 更稳定，P95差异 12.4%
3. **吞吐量**: 两者基本相当 (5.0% 差异)
4. **成本**: Aurora PostgreSQL 有压倒性优势（详见成本对比章节）

### 架构特点对比

#### OpenSearch Serverless

**优势**:
- ✅ 专为搜索优化的架构
- ✅ HNSW索引针对k-NN查询优化
- ✅ 自动扩展，无需手动配置
- ✅ 无VPC配置，部署简单

**劣势**:
- ❌ 成本高（最小4 OCU起步）
- ❌ 不支持ACID事务
- ❌ SQL能力有限
- ❌ 最终一致性

#### Aurora PostgreSQL + pgvector

**优势**:
- ✅ 成本低（按实际使用计费）
- ✅ 完整SQL支持（JOIN、聚合等）
- ✅ ACID事务保证
- ✅ 强一致性
- ✅ 可与现有RDS基础设施集成

**劣势**:
- ❌ 需要VPC配置，部署复杂
- ❌ 需要管理数据库连接池
- ❌ pgvector性能不如专用向量数据库

## 💰 成本对比与选型建议

### 📉 月度成本估算（Tiny规模）

| 服务 | 数据量 | 月度成本 | 成本构成 |
|------|--------|---------|---------|
| **AWS Bedrock (OpenSearch)** | 0.1GB | ~$700/月 | 4 OCU × $0.24 × 730h |
| **AWS Bedrock (Aurora PG)** | 0.1GB | ~$44/月 | 0.5 ACU × $0.12 × 730h |
| **阿里云百炼** | 0.1GB | ~¥200/月 | 按调用次数计费 |

**成本说明**:

- **OpenSearch Serverless**: 最小配置4 OCU（2索引+2搜索），按小时计费，无法按需缩容
- **Aurora PostgreSQL**: 最小0.5 ACU，按秒计费，空闲时可缩至最小
- **火山引擎/阿里云**: 根据资源使用量和API调用次数计费

### 💡 成本节省分析

选择 **Aurora PostgreSQL** 相比 **OpenSearch Serverless**:
- **月度节省**: $656/月
- **节省比例**: 93.7%
- **年度节省**: $7872/年

### 🎯 选型建议

#### 默认推荐: **Aurora PostgreSQL Serverless v2** ⭐

**适用场景**:
- ✅ 成本敏感型项目
- ✅ 需要完整SQL能力
- ✅ 要求强一致性
- ✅ 已有RDS基础设施
- ✅ 低到中等查询量（< 1000 QPS）

**不适用场景**:
- ❌ 对P95/P99延迟要求极高（如实时聊天）
- ❌ 需要零配置快速部署
- ❌ 团队缺乏数据库运维经验

#### 选择 OpenSearch Serverless 的场景

**适用场景**:
- ✅ 对延迟稳定性要求极高
- ✅ 预算充足，不在意成本
- ✅ 需要快速原型验证
- ✅ 纯向量搜索，不需要SQL
- ✅ 高并发搜索场景（> 1000 QPS）

#### 选择火山引擎/阿里云的场景

**适用场景**:
- ✅ 国内应用，需要低网络延迟
- ✅ 成本优化（相比AWS）
- ✅ 已有阿里云/字节跳动生态
- ✅ 需要中文优化的语义检索

### 📊 性能-成本综合评分

| 服务 | 性能评分 | 成本评分 | 易用性 | 综合评分 | 推荐指数 |
|------|---------|---------|--------|---------|---------|
| AWS Bedrock (Aurora PG) | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | 🏆 首选 |
| AWS Bedrock (OpenSearch) | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 备选 |
| 阿里云百炼 | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 国内备选 |

---

*本报告由云端知识库和记忆系统性能测试框架自动生成*