# 云端知识库性能测试报告

**生成时间**: 2026-02-01 00:11:06

## 📋 执行摘要

本次测试对比了 **4个云端知识库服务**，每个知识库已预先入库 **100个小学考试题目文档**：

**AWS Bedrock Knowledge Base** 的两种存储后端：

1. **OpenSearch Serverless** - P50: 594.65ms, P95: 1513.12ms, QPS: 1.07
2. **Aurora PostgreSQL Serverless v2** - P50: 783.45ms, P95: 1872.65ms, QPS: 0.91

### 核心发现

- **P50延迟**: Aurora 慢 31.7%
- **P95延迟**: Aurora 慢 23.8%
- **成本**: Aurora PostgreSQL 节省约 **93%** (~$656/月)
- **推荐**: 默认选择 **Aurora PostgreSQL**，除非对P95/P99延迟要求极高

## 🖥️ 测试环境

| 项目 | 信息 |
|------|------|
| **测试区域** | AWS us-east-1, 阿里云 cn-beijing, 火山引擎 cn-beijing |
| **AWS嵌入模型** | Amazon Titan Text Embeddings v2 (1024维) |
| **阿里云嵌入模型** | text-embedding-v4 |
| **火山引擎嵌入模型** | Doubao-embedding-240715 + 关键词模型 |
| **文档数量** | 100 个小学考试题目 |
| **测试框架** | Cloud Memory Test Framework v1.0 |
| **测试时间** | 2026-02-01 00:11:06 |

## 📊 测试概览

- **总测试数**: 4
- **知识库测试**: 4
- **文档数量**: 100 个
- **测试适配器**: AWSBedrockKB-Aurora, VolcengineVikingDB, AWSBedrockKB-OpenSearch, AlibabaBailian

## ⚙️ 测试配置

- **运行模式**: cloud
- **查询类型**: default
- **文档数量**: 100 (已预先入库)
- **查询数量**: 5
- **数据类型**: 小学考试题目
- **测试方式**: 直接查询（跳过文档上传）

## 🏗️ 知识库架构对比

### 🏗️ 架构特点对比

| 特性 | AWS OpenSearch | AWS Aurora PG | 火山引擎 VikingDB | 阿里云百炼 |
|------|---------------|---------------|------------------|------------|
| **底层技术** | OpenSearch + HNSW | PostgreSQL + pgvector | 自研向量引擎 | 自研向量引擎 |
| **索引类型** | HNSW | IVFFlat/HNSW | HNSW + Hybrid | 混合检索 |
| **SQL支持** | 有限 | ✅ 完整 | 有限 | 有限 |
| **ACID事务** | ❌ | ✅ | ❌ | ❌ |
| **自动扩展** | ✅ | ✅ | ✅ | ✅ |
| **部署复杂度** | 简单 | 中等(需VPC) | 简单 | 简单 |
| **中文优化** | 一般 | 一般 | ✅ 优化 | ✅ 深度优化 |
| **混合检索** | 支持 | 需自实现 | ✅ 原生支持 | ✅ 原生支持 |
| **Rerank** | 需自实现 | 需自实现 | ✅ 内置 | ✅ 内置 |


## ⚡ 性能对比

| 知识库 | P50延迟 | P95延迟 | QPS | P@1 | MRR | NDCG@10 |
|--------|---------|---------|-----|-----|-----|---------|
| AWSBedrockKB-OpenSearch | 594.65ms | 1513.12ms | 1.07 | 0.800 | 0.800 | 0.631 |
| AWSBedrockKB-Aurora | 783.45ms | 1872.65ms | 0.91 | 0.400 | 0.480 | 0.604 |
| VolcengineVikingDB | 1218.72ms | 2193.38ms | 0.56 | 0.000 | 0.092 | 0.114 |
| AlibabaBailian | 1422.09ms | 2307.95ms | 0.60 | 0.600 | 0.600 | 0.590 |

## 📊 详细结果

### AWSBedrockKB-OpenSearch

- 类型: knowledge_base
- 测试时间: 2026-02-01T00:10:21.279076

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 594.65ms |
| P95 | 1513.12ms |
| P99 | 1630.58ms |
| 平均 | 856.60ms |
| 最小 | 550.12ms |
| 最大 | 1659.95ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 1.07 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.8000 |
| Precision@5 | 0.6000 |
| Recall@10 | 0.5885 |
| MRR | 0.8000 |
| NDCG@10 | 0.6311 |

### AWSBedrockKB-Aurora

- 类型: knowledge_base
- 测试时间: 2026-02-01T00:10:30.784335

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 783.45ms |
| P95 | 1872.65ms |
| P99 | 2051.71ms |
| 平均 | 1080.40ms |
| 最小 | 763.57ms |
| 最大 | 2096.48ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 0.91 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.4000 |
| Precision@5 | 0.3600 |
| Recall@10 | 0.7736 |
| MRR | 0.4800 |
| NDCG@10 | 0.6043 |

### VolcengineVikingDB

- 类型: knowledge_base
- 测试时间: 2026-02-01T00:10:50.317002

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 1218.72ms |
| P95 | 2193.38ms |
| P99 | 2336.54ms |
| 平均 | 1392.11ms |
| 最小 | 927.56ms |
| 最大 | 2372.33ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 0.56 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.0000 |
| Precision@5 | 0.0400 |
| Recall@10 | 0.2333 |
| MRR | 0.0922 |
| NDCG@10 | 0.1136 |

### AlibabaBailian

- 类型: knowledge_base
- 测试时间: 2026-02-01T00:11:06.578616

**延迟指标**

| 指标 | 数值 |
|------|------|
| P50 | 1422.09ms |
| P95 | 2307.95ms |
| P99 | 2360.84ms |
| 平均 | 1601.84ms |
| 最小 | 856.24ms |
| 最大 | 2374.06ms |

**吞吐量指标**

| 指标 | 数值 |
|------|------|
| QPS | 0.60 |
| 总请求数 | 5 |
| 成功请求 | 5 |
| 失败请求 | 0 |
| 错误率 | 0.00% |

**质量指标**

| 指标 | 数值 |
|------|------|
| Precision@1 | 0.6000 |
| Precision@5 | 0.5600 |
| Recall@10 | 0.5601 |
| MRR | 0.6000 |
| NDCG@10 | 0.5898 |

## 📊 知识库综合对比分析

### 🏆 综合评分对比

| 知识库 | 性能得分 | 质量得分 | 成本得分 | 易用性 | 综合评分 | 推荐场景 |
|--------|---------|---------|---------|--------|---------|----------|
| AWSBedrockKB-OpenSearch | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | 性能优先 |
| AWSBedrockKB-Aurora | ⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 成本优先 |
| VolcengineVikingDB | ⭐⭐ | ⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐ | 国内应用 |
| AlibabaBailian | ⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 质量优先 |

### 🎯 检索质量深度分析

**质量冠军**: AWSBedrockKB-OpenSearch

- **MRR (Mean Reciprocal Rank)**: 0.800 - 衡量正确结果的平均排名位置
- **Precision@1**: 0.800 - 首位结果的准确率
- **召回能力**: 在相同查询下返回更多相关文档

**质量差异分析**:

1. 🥇 **AWSBedrockKB-OpenSearch** - MRR: 0.800, P@1: 0.800 (最佳检索质量)
2. 🥈 **AlibabaBailian** - MRR: 0.600, P@1: 0.600
3. 🥉 **AWSBedrockKB-Aurora** - MRR: 0.480, P@1: 0.400
4. **VolcengineVikingDB** - MRR: 0.092, P@1: 0.000

### ⚡ 性能特点总结

- **最快响应**: AWSBedrockKB-OpenSearch (P50: 594.65ms)
- **质量最佳**: AWSBedrockKB-OpenSearch (MRR: 0.800)
- **成本最优**: AWS Bedrock (Aurora) (~$44/月)


## 🔬 AWS Bedrock KB 存储后端深度对比

AWS Bedrock Knowledge Base支持多种向量存储后端，本次测试对比了两种主流方案：

### 性能指标详细对比

| 指标 | OpenSearch Serverless | Aurora PostgreSQL | 差异 | 赢家 |
|------|----------------------|------------------|------|------|
| **P50 延迟** | 594.65ms | 783.45ms | +31.7% | ✅ OpenSearch |
| **P95 延迟** | 1513.12ms | 1872.65ms | +23.8% | ✅ OpenSearch |
| **P99 延迟** | 1630.58ms | 2051.71ms | +25.8% | ✅ OpenSearch |
| **平均延迟** | 856.60ms | 1080.40ms | +26.1% | ✅ OpenSearch |
| **QPS** | 1.07 | 0.91 | -15.0% | ✅ OpenSearch |
| **成功率** | 100% | 100% | 0% | ≈ 相当 |

### 关键发现

1. **中位数性能 (P50)**: OpenSearch Serverless 表现略好，差异 31.7%
2. **尾部延迟 (P95/P99)**: OpenSearch Serverless 更稳定，P95差异 23.8%
3. **吞吐量**: 两者基本相当 (15.0% 差异)
4. **成本**: Aurora PostgreSQL 有压倒性优势（详见成本对比章节）

### 架构特点对比

#### OpenSearch Serverless

**优势**:
- ✅ 专为搜索优化的架构
- ✅ HNSW索引针对k-NN查询优化
- ✅ 自动扩展，无需手动配置
- ✅ 无VPC配置，部署简单
- ✅ 尾部延迟更低

**劣势**:
- ❌ 成本高（最小4 OCU起步）
- ❌ 不支持ACID事务
- ❌ SQL能力有限
- ❌ 最终一致性

#### Aurora PostgreSQL + pgvector

**优势**:
- ✅ 成本低（按实际使用计费）
- ✅ 完整SQL支持（JOIN、聚合等）
- ✅ ACID事务保证
- ✅ 强一致性
- ✅ 可与现有RDS基础设施集成

**劣势**:
- ❌ 需要VPC配置，部署复杂
- ❌ P95/P99延迟较高
- ❌ 需要管理数据库连接池
- ❌ pgvector性能不如专用向量数据库

## 💰 成本对比与选型建议

### 📉 月度成本估算（Tiny规模）

| 服务 | 数据量 | 月度成本 | 成本构成 |
|------|--------|---------|---------|
| **AWS Bedrock (OpenSearch)** | 0.1GB | ~$700/月 | 4 OCU × $0.24 × 730h |
| **AWS Bedrock (Aurora PG)** | 0.1GB | ~$44/月 | 0.5 ACU × $0.12 × 730h |
| **火山引擎 VikingDB** | 0.1GB | ~¥300/月 | 实例费 + 存储费 |
| **阿里云百炼** | 0.1GB | ~¥200/月 | 按调用次数计费 |

**成本说明**:

- **OpenSearch Serverless**: 最小配置4 OCU（2索引+2搜索），按小时计费，无法按需缩容
- **Aurora PostgreSQL**: 最小0.5 ACU，按秒计费，空闲时可缩至最小
- **火山引擎/阿里云**: 根据资源使用量和API调用次数计费

### 💡 成本节省分析

选择 **Aurora PostgreSQL** 相比 **OpenSearch Serverless**:
- **月度节省**: $656/月
- **节省比例**: 93.7%
- **年度节省**: $7872/年

### 🎯 选型建议

#### 默认推荐: **Aurora PostgreSQL Serverless v2** ⭐

**适用场景**:
- ✅ 成本敏感型项目
- ✅ 需要完整SQL能力
- ✅ 要求强一致性
- ✅ 已有RDS基础设施
- ✅ 低到中等查询量（< 1000 QPS）

**不适用场景**:
- ❌ 对P95/P99延迟要求极高（如实时聊天）
- ❌ 需要零配置快速部署
- ❌ 团队缺乏数据库运维经验

#### 选择 OpenSearch Serverless 的场景

**适用场景**:
- ✅ 对延迟稳定性要求极高
- ✅ 预算充足，不在意成本
- ✅ 需要快速原型验证
- ✅ 纯向量搜索，不需要SQL
- ✅ 高并发搜索场景（> 1000 QPS）

#### 选择火山引擎/阿里云的场景

**适用场景**:
- ✅ 国内应用，需要低网络延迟
- ✅ 成本优化（相比AWS）
- ✅ 已有阿里云/字节跳动生态
- ✅ 需要中文优化的语义检索

### 📊 性能-成本综合评分

| 服务 | 性能评分 | 成本评分 | 易用性 | 综合评分 | 推荐指数 |
|------|---------|---------|--------|---------|---------|
| AWS Bedrock (Aurora PG) | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | 🏆 首选 |
| AWS Bedrock (OpenSearch) | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 备选 |
| 火山引擎 VikingDB | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | 国内优选 |
| 阿里云百炼 | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | 国内备选 |

---

*本报告由云端知识库性能测试框架自动生成*